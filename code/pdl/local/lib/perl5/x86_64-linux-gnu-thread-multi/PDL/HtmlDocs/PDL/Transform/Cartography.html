<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>PDL::Transform::Cartography - Useful cartographic projections</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#GENERAL-NOTES-ON-CARTOGRAPHY">GENERAL NOTES ON CARTOGRAPHY</a></li>
  <li><a href="#GENERAL-NOTES-ON-PERSPECTIVE-AND-SCIENTIFIC-IMAGES">GENERAL NOTES ON PERSPECTIVE AND SCIENTIFIC IMAGES</a></li>
  <li><a href="#TRANSVERSE-OBLIQUE-PROJECTIONS-STANDARD-OPTIONS">TRANSVERSE &amp; OBLIQUE PROJECTIONS; STANDARD OPTIONS</a></li>
  <li><a href="#EXAMPLES">EXAMPLES</a></li>
  <li><a href="#NOTES">NOTES</a></li>
  <li><a href="#AUTHOR">AUTHOR</a></li>
  <li><a href="#FUNCTIONS">FUNCTIONS</a>
    <ul>
      <li><a href="#graticule">graticule</a></li>
      <li><a href="#earth_coast">earth_coast</a></li>
      <li><a href="#earth_image">earth_image</a></li>
      <li><a href="#earth_shape">earth_shape</a></li>
      <li><a href="#clean_lines">clean_lines</a></li>
      <li><a href="#t_raster2float">t_raster2float</a></li>
      <li><a href="#t_raster2fits">t_raster2fits</a></li>
      <li><a href="#t_unit_sphere">t_unit_sphere</a></li>
      <li><a href="#t_rot_sphere">t_rot_sphere</a></li>
      <li><a href="#t_orthographic">t_orthographic</a></li>
      <li><a href="#t_carree">t_carree</a></li>
      <li><a href="#t_mercator">t_mercator</a></li>
      <li><a href="#t_utm">t_utm</a></li>
      <li><a href="#t_sin_lat">t_sin_lat</a></li>
      <li><a href="#t_sinusoidal">t_sinusoidal</a></li>
      <li><a href="#t_conic">t_conic</a></li>
      <li><a href="#t_albers">t_albers</a></li>
      <li><a href="#t_lambert">t_lambert</a></li>
      <li><a href="#t_stereographic">t_stereographic</a></li>
      <li><a href="#t_gnomonic">t_gnomonic</a></li>
      <li><a href="#t_az_eqd">t_az_eqd</a></li>
      <li><a href="#t_az_eqa">t_az_eqa</a></li>
      <li><a href="#t_aitoff">t_aitoff</a></li>
      <li><a href="#t_hammer">t_hammer</a></li>
      <li><a href="#t_zenithal">t_zenithal</a></li>
      <li><a href="#t_vertical">t_vertical</a></li>
      <li><a href="#t_perspective">t_perspective</a></li>
    </ul>
  </li>
</ul>

<h1 id="NAME">NAME</h1>

<p>PDL::Transform::Cartography - Useful cartographic projections</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code> # make a Mercator map of Earth
 use PDL::Transform::Cartography;
 $x = earth_coast();
 $x = graticule(10,2)-&gt;glue(1,$x);
 $t = t_mercator;
 $w = pgwin(xs);
 $w-&gt;lines($t-&gt;apply($x)-&gt;clean_lines());</code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>PDL::Transform::Cartography includes a variety of useful cartographic and observing projections (mappings of the surface of a sphere), including reprojected observer coordinates. See <a href="../Transform.html">PDL::Transform</a> for more information about image transforms in general.</p>

<p>Cartographic transformations are used for projecting not just terrestrial maps, but also any nearly spherical surface including the Sun, the Celestial sphere, various moons and planets, distant stars, etc. They also are useful for interpreting scientific images, which are themselves generally projections of a sphere onto a flat focal plane (e.g. the <a href="#t_gnomonic">&quot;t_gnomonic&quot;</a> projection).</p>

<p>Unless otherwise noted, all the transformations in this file convert from (theta,phi) coordinates on the unit sphere (e.g. (lon,lat) on a planet or (RA,dec) on the celestial sphere) into some sort of projected coordinates, and have inverse transformations that convert back to (theta,phi). This is equivalent to working from the equidistant cylindrical (or <a href="#t_carree">&quot;plate carree&quot;</a>) projection, if you are a cartography wonk.</p>

<p>The projected coordinates are generally in units of body radii (radians), so that multiplying the output by the scale of the map yields physical units that are correct wherever the scale is correct for that projection. For example, areas should be correct everywhere in the authalic projections; and linear scales are correct along meridians in the equidistant projections and along the standard parallels in all the projections.</p>

<p>The transformations that are authalic (equal-area), conformal (equal-angle), azimuthal (circularly symmetric), or perspective (true perspective on a focal plane from some viewpoint) are marked. The first two categories are mutually exclusive for all but the <a href="#t_unit_sphere">&quot;unit sphere&quot;</a> 3-D projection.</p>

<p>Extra dimensions tacked on to each point to be transformed are, in general, ignored. That is so that you can add on an extra index to keep track of pen color. For example, <a href="#earth_coast">&quot;earth_coast&quot;</a> returns a 3x&lt;n&gt; ndarray containing (lon, lat, pen) at each list location. Transforming the vector list retains the pen value as the first index after the dimensional directions.</p>

<h1 id="GENERAL-NOTES-ON-CARTOGRAPHY">GENERAL NOTES ON CARTOGRAPHY</h1>

<p>Unless otherwise noted, the transformations and miscellaneous information in this section are taken from Snyder &amp; Voxland 1989: &quot;An Album of Map Projections&quot;, US Geological Survey Professional Paper 1453, US Printing Office (Denver); and from Snyder 1987: &quot;Map Projections - A Working Manual&quot;, US Geological Survey Professional Paper 1395, US Printing Office (Denver, USA). You can obtain your own copy of both by contacting the U.S. Geological Survey, Federal Center, Box 25425, Denver, CO 80225 USA.</p>

<p>The mathematics of cartography have a long history, and the details are far trickier than the broad overview. For terrestrial (and, in general, planetary) cartography, the best reference datum is not a sphere but an oblate ellipsoid due to centrifugal force from the planet&#39;s rotation. Furthermore, because all rocky planets, including Earth, have randomly placed mass concentrations that affect the gravitational field, the reference gravitational isosurface (sea level on Earth) is even more complex than an ellipsoid and, in general, different ellipsoids have been used for different locations at the same time and for the same location at different times.</p>

<p>The transformations in this package use a spherical datum and hence include global distortion at about the 0.5% level for terrestrial maps (Earth&#39;s oblateness is ~1/300). This is roughly equal to the dimensional precision of physical maps printed on paper (due to stretching and warping of the paper) but is significant at larger scales (e.g. for regional maps). If you need more precision than that, you will want to implement and use the ellipsoidal transformations from Snyder 1987 or another reference work on geodesy. A good name for that package would be <code>...::Cartography::Geodetic</code>.</p>

<h1 id="GENERAL-NOTES-ON-PERSPECTIVE-AND-SCIENTIFIC-IMAGES">GENERAL NOTES ON PERSPECTIVE AND SCIENTIFIC IMAGES</h1>

<p>Cartographic transformations are useful for interpretation of scientific images, as all cameras produce projections of the celestial sphere onto the focal plane of the camera. A simple (single-element) optical system with a planar focal plane generates <a href="#t_gnomonic">gnomonic</a> images -- that is to say, gnomonic projections of a portion of the celestial sphere near the paraxial direction. This is the projection that most consumer grade cameras produce.</p>

<p>Magnification in an optical system changes the angle of incidence of the rays on the focal plane for a given angle of incidence at the aperture. For example, a 10x telescope with a 2 degree field of view exhibits the same gnomonic distortion as a simple optical system with a 20 degree field of view. Wide-angle optics typically have magnification less than 1 (&#39;fisheye lenses&#39;), reducing the gnomonic distortion considerably but introducing <a href="#t_az_eqd">&quot;equidistant azimuthal&quot;</a> distortion -- there&#39;s no such thing as a free lunch!</p>

<p>Because many solar-system objects are spherical, PDL::Transform::Cartography includes perspective projections for producing maps of spherical bodies from perspective views. Those projections are <a href="#t_vertical">&quot;t_vertical&quot;</a> and <a href="#t_perspective">&quot;t_perspective&quot;</a>. They map between (lat,lon) on the spherical body and planar projected coordinates at the viewpoint. <a href="#t_vertical">&quot;t_vertical&quot;</a> is the vertical perspective projection given by Snyder, but <a href="#t_perspective">&quot;t_perspective&quot;</a> is a fully general perspective projection that also handles magnification correction.</p>

<h1 id="TRANSVERSE-OBLIQUE-PROJECTIONS-STANDARD-OPTIONS">TRANSVERSE &amp; OBLIQUE PROJECTIONS; STANDARD OPTIONS</h1>

<p>Oblique projections rotate the sphere (and graticule) to an arbitrary angle before generating the projection; transverse projections rotate the sphere exactly 90 degrees before generating the projection.</p>

<p>Most of the projections accept the following standard options, useful for making transverse and oblique projection maps.</p>

<dl>

<dt id="o-origin-Origin-default-0-0-0">o, origin, Origin [default (0,0,0)]</dt>
<dd>

<p>The origin of the oblique map coordinate system, in (old-theta, old-phi) coordinates.</p>

</dd>
<dt id="r-roll-Roll-default-0.0">r, roll, Roll [default 0.0]</dt>
<dd>

<p>The roll angle of the sphere about the origin, measured CW from (N = up) for reasonable values of phi and CW from (S = up) for unreasonable values of phi. This is equivalent to observer roll angle CCW from the same direction.</p>

</dd>
<dt id="u-unit-Unit-default-degree">u, unit, Unit [default &#39;degree&#39;]</dt>
<dd>

<p>This is the name of the angular unit to use in the lon/lat coordinate system.</p>

</dd>
<dt id="b-B">b, B</dt>
<dd>

<p>The &quot;B&quot; angle of the body -- used for extraterrestrial maps. Setting this parameter is exactly equivalent to setting the phi component of the origin, and in fact overrides it.</p>

</dd>
<dt id="l-L">l,L</dt>
<dd>

<p>The longitude of the central meridian as observed -- used for extraterrestrial maps. Setting this parameter is exactly equivalent to setting the theta component of the origin, and in fact overrides it.</p>

</dd>
<dt id="p-P">p,P</dt>
<dd>

<p>The &quot;P&quot; (or position) angle of the body -- used for extraterrestrial maps. This parameter is a synonym for the roll angle, above.</p>

</dd>
<dt id="bad-Bad-missing-Missing-default-nan">bad, Bad, missing, Missing [default nan]</dt>
<dd>

<p>This is the value that missing points get. Mainly useful for the inverse transforms. (This should work fine if set to BAD, if you have bad-value support compiled in). The default nan is asin(1.2), calculated at load time.</p>

</dd>
</dl>

<h1 id="EXAMPLES">EXAMPLES</h1>

<p>Draw a Mercator map of the world on-screen:</p>

<pre><code>   $w = pgwin(xs);
   $w-&gt;lines(earth_coast-&gt;apply(t_mercator)-&gt;clean_lines);</code></pre>

<p>Here, <code>earth_coast()</code> returns a 3xn ndarray containing (lon, lat, pen) values for the included world coastal outline; <code>t_mercator</code> converts the values to projected Mercator coordinates, and <code>clean_lines</code> breaks lines that cross the 180th meridian.</p>

<p>Draw a Mercator map of the world, with lon/lat at 10 degree intervals:</p>

<pre><code>   $w = pgwin(xs)
   $x = earth_coast()-&gt;glue(1,graticule(10,1));
   $w-&gt;lines($x-&gt;apply(t_mercator)-&gt;clean_lines);</code></pre>

<p>This works just the same as the first example, except that a map graticule has been applied with interline spacing of 10 degrees lon/lat and inter-vertex spacing of 1 degree (so that each meridian contains 181 points, and each parallel contains 361 points).</p>

<h1 id="NOTES">NOTES</h1>

<p>Currently angular conversions are rather simpleminded. A list of common conversions is present in the main constructor, which inserts a conversion constant to radians into the {params} field of the new transform. Something like Math::Convert::Units should be used instead to generate the conversion constant.</p>

<p>A cleaner higher-level interface is probably needed (see the examples); for example, earth_coast could return a graticule if asked, instead of needing one to be glued on.</p>

<p>The class structure is somewhat messy because of the varying needs of the different transformations. PDL::Transform::Cartography is a base class that interprets the origin options and sets up the basic machinery of the Transform. The conic projections have their own subclass, PDL::Transform::Conic, that interprets the standard parallels. Since the cylindrical and azimuthal projections are pretty simple, they are not subclassed.</p>

<p>The perl 5.6.1 compiler is quite slow at adding new classes to the structure, so it does not makes sense to subclass new transformations merely for the sake of pedantry.</p>

<h1 id="AUTHOR">AUTHOR</h1>

<p>Copyright 2002, Craig DeForest (deforest@boulder.swri.edu). This module may be modified and distributed under the same terms as PDL itself. The module comes with NO WARRANTY.</p>

<p>The included digital world map is derived from the 1987 CIA World Map, translated to ASCII in 1988 by Joe Dellinger (geojoe@freeusp.org) and simplified in 1995 by Kirk Johnson (tuna@indra.com) for the program XEarth. The map comes with NO WARRANTY. An ASCII version of the map, and a sample PDL function to read it, may be found in the Demos subdirectory of the PDL source distribution.</p>

<h1 id="FUNCTIONS">FUNCTIONS</h1>

<p>The module exports both transform constructors (&#39;t_&lt;foo&gt;&#39;) and some auxiliary functions (no leading &#39;t_&#39;).</p>

<h2 id="graticule">graticule</h2>

<pre><code>   $lonlatp     = graticule(&lt;grid-spacing&gt;,&lt;line-segment-size&gt;);   
   $lonlatp     = graticule(&lt;grid-spacing&gt;,&lt;line-segment-size&gt;,1);</code></pre>

<p>(Cartography) PDL constructor - generate a lat/lon grid.</p>

<p>Returns a grid of meridians and parallels as a list of vectors suitable for sending to <a href="../Graphics/PGPLOT/Window.html#lines">PDL::Graphics::PGPLOT::Window::lines</a> for plotting. The grid is in degrees in (theta, phi) coordinates -- this is (E lon, N lat) for terrestrial grids or (RA, dec) for celestial ones. You must then transform the graticule in the same way that you transform the map.</p>

<p>You can attach the graticule to a vector map using the syntax:</p>

<pre><code>    $out = graticule(10,2)-&gt;glue(1,$map);</code></pre>

<p>In array context you get back a 2-element list containing an ndarray of the (theta,phi) pairs and an ndarray of the pen values (1 or 0) suitable for calling <a href="../Graphics/PGPLOT/Window.html#lines">PDL::Graphics::PGPLOT::Window::lines</a>. In scalar context the two elements are combined into a single ndarray.</p>

<p>The pen values associated with the graticule are negative, which will cause <a href="../Graphics/PGPLOT/Window.html#lines">PDL::Graphics::PGPLOT::Window::lines</a> to plot them as hairlines.</p>

<p>If a third argument is given, it is a hash of options, which can be:</p>

<dl>

<dt id="nan---if-true-use-two-columns-instead-of-three-and-separate-lines-with-a-nan-break">nan - if true, use two columns instead of three, and separate lines with a &#39;nan&#39; break</dt>
<dd>

</dd>
<dt id="lonpos---if-true-all-reported-longitudes-are-positive-0-to-360-instead-of--180-to-180">lonpos - if true, all reported longitudes are positive (0 to 360) instead of (-180 to 180).</dt>
<dd>

</dd>
<dt id="dup---if-true-the-meridian-at-the-far-boundary-is-duplicated">dup - if true, the meridian at the far boundary is duplicated.</dt>
<dd>

</dd>
</dl>

<h2 id="earth_coast">earth_coast</h2>

<pre><code>  $x = earth_coast()</code></pre>

<p>(Cartography) PDL constructor - coastline map of Earth</p>

<p>Returns a vector coastline map based on the 1987 CIA World Coastline database (see author information). The vector coastline data are in plate carree format so they can be converted to other projections via the <a href="../Transform.html#apply">apply</a> method and cartographic transforms, and are suitable for plotting with the <a href="../Graphics/PGPLOT/Window.html#lines">lines</a> method in the PGPLOT output library: the first dimension is (X,Y,pen) with breaks having a pen value of 0 and hairlines having negative pen values. The second dimension broadcasts over all the points in the data set.</p>

<p>The vector map includes lines that pass through the antipodean meridian, so if you want to plot it without reprojecting, you should run it through <a href="#clean_lines">&quot;clean_lines&quot;</a> first:</p>

<pre><code>    $w = pgwin();
    $w-&gt;lines(earth_coast-&gt;clean_lines);     # plot plate carree map of world
    $w-&gt;lines(earth_coast-&gt;apply(t_gnomonic))# plot gnomonic map of world</code></pre>

<p><code>earth_coast</code> is just a quick-and-dirty way of loading the file &quot;earth_coast.vec.fits&quot; that is part of the normal installation tree.</p>

<h2 id="earth_image">earth_image</h2>

<pre><code> $rgb = earth_image()</code></pre>

<p>(Cartography) PDL constructor - RGB pixel map of Earth</p>

<p>Returns an RGB image of Earth based on data from the MODIS instrument on the NASA EOS/Terra satellite. (You can get a full-resolution image from <a href="http://earthobservatory.nasa.gov/Newsroom/BlueMarble/">http://earthobservatory.nasa.gov/Newsroom/BlueMarble/</a>). The image is a plate carree map, so you can convert it to other projections via the <a href="../Transform.html#map">map</a> method and cartographic transforms.</p>

<p>This is just a quick-and-dirty way of loading the earth-image files that are distributed along with PDL.</p>

<h2 id="earth_shape">earth_shape</h2>

<pre><code> $fits_shape = earth_shape()</code></pre>

<p>(Cartography) PDL constructor - height map of Earth</p>

<p>Returns a height map of Earth based on data from the General Bathymetric Chart of the Oceans (GEBCO) produced by the British Oceanographic Data Centre. (You can get a full-resolution image from <a href="http://visibleearth.nasa.gov/view.php?id=73934">http://visibleearth.nasa.gov/view.php?id=73934</a>). The image is a plate carree map, so you can convert it to other projections via the <a href="../Transform.html#map">map</a> method and cartographic transforms. The data is from 8-bit grayscale (so only 256 levels), but is returned in a similar format to <a href="#earth_image">&quot;earth_image&quot;</a>. The range represents a span of 6400m, so Everest and the Marianas Trench are not accurately represented.</p>

<p>To turn this into a <code>float</code>, (<code>lonlatradius,x,y</code>) with <code>x</code> and <code>y</code> in radians, and the radius as a <code>float</code> as a proportion of the Earth&#39;s mean radius, use <a href="#t_raster2float">&quot;t_raster2float&quot;</a>. The Earth is treated here as a perfect sphere with sea level at radius 6,371km.</p>

<pre><code>  Value       Hex value   Float    From centre in km   Float as radius
  Base        00          0.0      6370.69873km        0.99995
  Sea level   0C          0.04705  6371km              1.0
  Highest     FF          1.0      6377.09863km        1.00096</code></pre>

<p>Code:</p>

<pre><code>  $shape = earth_shape();
  $floats = t_raster2float()-&gt;apply($shape-&gt;mv(2,0));
  $lonlatradius = $floats-&gt;slice(&#39;0:2&#39;); # r g b all same
  $lonlatradius-&gt;slice(&#39;(2)&#39;) *= float((6377.09863 - 6370.69873) / 6371);
  $lonlatradius-&gt;slice(&#39;(2)&#39;) += float(6370.69873 / 6371);</code></pre>

<h2 id="clean_lines">clean_lines</h2>

<pre><code> $x = clean_lines(t_mercator-&gt;apply(scalar(earth_coast())));
 $x = clean_lines($line_pen, [threshold]);
 $x = $lines-&gt;clean_lines;</code></pre>

<p>(Cartography) PDL method - remove projection irregularities</p>

<p><code>clean_lines</code> massages vector data to remove jumps due to singularities in the transform.</p>

<p>In the first (scalar) form, <code>$line_pen</code> contains both (X,Y) points and pen values suitable to be fed to <a href="../Graphics/PGPLOT/Window.html#lines">lines</a>: in the second (list) form, <code>$lines</code> contains the (X,Y) points and <code>$pen</code> contains the pen values.</p>

<p><code>clean_lines</code> assumes that all the outline polylines are local -- that is to say, there are no large jumps. Any jumps larger than a threshold size are broken by setting the appropriate pen values to 0.</p>

<p>The <code>threshold</code> parameter sets the relative size of the largest jump, relative to the map range (as determined by a min/max operation). The default size is 0.1.</p>

<p>NOTES</p>

<p>This almost never catches stuff near the apex of cylindrical maps, because the anomalous vectors get arbitrarily small. This could be improved somewhat by looking at individual runs of the pen and using a relative length scale that is calibrated to the rest of each run. it is probably not worth the computational overhead.</p>

<h2 id="t_raster2float">t_raster2float</h2>

<pre><code>  $t = t_raster2float();</code></pre>

<p>(Cartography) Convert a raster (3,x,y) to <code>float</code> (lonlatrgb,x,y)</p>

<p>Assumes <code>bytes</code> input, and radians and <code>float</code> output, with the first 2 coordinates suitable for use as plate carree.</p>

<h2 id="t_raster2fits">t_raster2fits</h2>

<pre><code>  $t = t_raster2fits();</code></pre>

<p>(Cartography) Convert a raster (3,x,y) to FITS plate carree (x,y,3)</p>

<p>Adds suitable <code>hdr</code>. Assumes degrees. Used by <a href="#earth_image">&quot;earth_image&quot;</a>.</p>

<h2 id="t_unit_sphere">t_unit_sphere</h2>

<pre><code>  $t = t_unit_sphere(&lt;options&gt;);</code></pre>

<p>(Cartography) 3-D globe projection (conformal; authalic)</p>

<p>This is similar to the inverse of <a href="../Transform.html#t_spherical">t_spherical</a>, but the inverse transform projects 3-D coordinates onto the unit sphere, yielding only a 2-D (lon/lat) output. Similarly, the forward transform deprojects 2-D (lon/lat) coordinates onto the surface of a unit sphere.</p>

<p>The cartesian system has its Z axis pointing through the pole of the (lon,lat) system, and its X axis pointing through the equator at the prime meridian.</p>

<p>Unit sphere mapping is unusual in that it is both conformal and authalic. That is possible because it properly embeds the sphere in 3-space, as a notional globe.</p>

<p>This is handy as an intermediate step in lots of transforms, as Cartesian 3-space is cleaner to work with than spherical 2-space.</p>

<p>Higher dimensional indices are preserved, so that &quot;rider&quot; indices (such as pen value) are propagated.</p>

<p>There is no oblique transform for t_unit_sphere, largely because it&#39;s so easy to rotate the output using t_linear once it&#39;s out into Cartesian space. In fact, the other projections implement oblique transforms by <a href="../Transform.html#t_wrap">wrapping</a> <a href="../Transform.html#t_linear">t_linear</a> with <a href="#t_unit_sphere">&quot;t_unit_sphere&quot;</a>.</p>

<p>OPTIONS:</p>

<dl>

<dt id="radius-Radius-default-1.0">radius, Radius (default 1.0)</dt>
<dd>

<p>The radius of the sphere, for the inverse transform. (Radius is ignored in the forward transform). Defaults to 1.0 so that the resulting Cartesian coordinates are in units of &quot;body radii&quot;.</p>

</dd>
</dl>

<h2 id="t_rot_sphere">t_rot_sphere</h2>

<pre><code>    $t = t_rot_sphere({origin=&gt;[&lt;theta&gt;,&lt;phi&gt;],roll=&gt;[&lt;roll&gt;]});</code></pre>

<p>(Cartography) Generate oblique projections</p>

<p>You feed in the origin in (theta,phi) and a roll angle, and you get back out (theta&#39;, phi&#39;) coordinates. This is useful for making oblique or transverse projections: just compose t_rot_sphere with your favorite projection and you get an oblique one.</p>

<p>Most of the projections automagically compose themselves with t_rot_sphere if you feed in an origin or roll angle.</p>

<p>t_rot_sphere converts the base plate carree projection (straight lon, straight lat) to a Cassini projection.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
</dl>

<h2 id="t_orthographic">t_orthographic</h2>

<pre><code>    $t = t_orthographic(&lt;options&gt;);</code></pre>

<p>(Cartography) Ortho. projection (azimuthal; perspective)</p>

<p>This is a perspective view as seen from infinite distance. You can specify the sub-viewer point in (lon,lat) coordinates, and a rotation angle of the map CW from (north=up). This is equivalent to specify viewer roll angle CCW from (north=up).</p>

<p>t_orthographic is a convenience interface to t_unit_sphere -- it is implemented as a composition of a t_unit_sphere call, a rotation, and a slice.</p>

<p>[*] In the default case where the near hemisphere is mapped, the inverse exists. There is no single inverse for the whole-sphere case, so the inverse transform superimposes everything on a single hemisphere. If you want an invertible 3-D transform, you want <a href="#t_unit_sphere">&quot;t_unit_sphere&quot;</a>.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS1">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="m-mask-Mask-h-hemisphere-Hemisphere-default-near">m, mask, Mask, h, hemisphere, Hemisphere [default &#39;near&#39;]</dt>
<dd>

<p>The hemisphere to keep in the projection (see <a href="./Cartography.html">PDL::Transform::Cartography</a>).</p>

</dd>
</dl>

<p>NOTES</p>

<p>Alone of the various projections, this one does not use <a href="#t_rot_sphere">&quot;t_rot_sphere&quot;</a> to handle the standard options, because the cartesian coordinates of the rotated sphere are already correctly projected -- t_rot_sphere would put them back into (theta&#39;, phi&#39;) coordinates.</p>

<h2 id="t_carree">t_carree</h2>

<pre><code>    $t = t_carree(&lt;options&gt;);</code></pre>

<p>(Cartography) Plate Carree projection (cylindrical; equidistant)</p>

<p>This is the simple Plate Carree projection -- also called a &quot;lat/lon plot&quot;. The horizontal axis is theta; the vertical axis is phi. This is a no-op if the angular unit is radians; it is a simple scale otherwise.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS2">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="s-std-standard-Standard-default-0">s, std, standard, Standard (default 0)</dt>
<dd>

<p>The standard parallel where the transformation is conformal. Conformality is achieved by shrinking of the horizontal scale to match the vertical scale (which is correct everywhere).</p>

</dd>
</dl>

<h2 id="t_mercator">t_mercator</h2>

<pre><code>    $t = t_mercator(&lt;options&gt;);</code></pre>

<p>(Cartography) Mercator projection (cylindrical; conformal)</p>

<p>This is perhaps the most famous of all map projections: meridians are mapped to parallel vertical lines and parallels are unevenly spaced horizontal lines. The poles are shifted to +/- infinity. The output values are in units of globe-radii for easy conversion to kilometers; hence the horizontal extent is -pi to pi.</p>

<p>You can get oblique Mercator projections by specifying the <code>origin</code> or <code>roll</code> options; this is implemented via <a href="#t_rot_sphere">&quot;t_rot_sphere&quot;</a>.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS3">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="c-clip-Clip-default-75-degrees">c, clip, Clip (default 75 [degrees])</dt>
<dd>

<p>The north/south clipping boundary of the transformation. Because the poles are displaced to infinity, many applications require a clipping boundary. The value is in whatever angular unit you set with the standard &#39;units&#39; option. The default roughly matches interesting landforms on Earth. For no clipping at all, set b=&gt;0. For asymmetric clipping, use a 2-element list ref or ndarray.</p>

</dd>
<dt id="s-std-Standard-default-0">s, std, Standard (default 0)</dt>
<dd>

<p>This is the parallel at which the map has correct scale. The scale is also correct at the parallel of opposite sign.</p>

</dd>
</dl>

<h2 id="t_utm">t_utm</h2>

<pre><code>  $t = t_utm(&lt;zone&gt;,&lt;options&gt;);</code></pre>

<p>(Cartography) Universal Transverse Mercator projection (cylindrical)</p>

<p>This is the internationally used UTM projection, with 2 subzones (North/South). The UTM zones are parametrized individually, so if you want a Zone 30 map you should use <code>t_utm(30)</code>. By default you get the northern subzone, so that locations in the southern hemisphere get negative Y coordinates. If you select the southern subzone (with the &quot;subzone=&gt;-1&quot; option), you get offset southern UTM coordinates.</p>

<p>The 20-subzone military system is not yet supported. If/when it is implemented, you will be able to enter &quot;subzone=&gt;[a-t]&quot; to select a N/S subzone.</p>

<p>Note that UTM is really a family of transverse Mercator projections with different central meridia. Each zone properly extends for six degrees of longitude on either side of its appropriate central meridian, with Zone 1 being centered at -177 degrees longitude (177 west). Properly speaking, the zones only extend from 80 degrees south to 84 degrees north; but this implementation lets you go all the way to 90 degrees. The default UTM coordinates are meters. The origin for each zone is on the equator, at an easting of -500,000 meters.</p>

<p>The default output units are meters, assuming that you are wanting a map of the Earth. This will break for bodies other than Earth (which have different radii and hence different conversions between lat/lon angle and meters).</p>

<p>The standard UTM projection has a slight reduction in scale at the prime meridian of each zone: the transverse Mercator projection&#39;s standard &quot;parallels&quot; are 180km e/w of the central meridian. However, many Europeans prefer the &quot;Gauss-Kruger&quot; system, which is virtually identical to UTM but with a normal tangent Mercator (standard parallel on the prime meridian). To get this behavior, set &quot;gk=&gt;1&quot;.</p>

<p>Like the rest of the PDL::Transform::Cartography package, t_utm uses a spherical datum rather than the &quot;official&quot; ellipsoidal datums for the UTM system.</p>

<p>This implementation was derived from the rather nice description by Denis J. Dean, located on the web at: http://www.cnr.colostate.edu/class_info/nr502/lg3/datums_coordinates/utm.html</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-OPTIONS">STANDARD OPTIONS</dt>
<dd>

<p>(No positional options -- Origin and Roll are ignored)</p>

</dd>
<dt id="ou-ounit-OutputUnit-default-meters">ou, ounit, OutputUnit (default &#39;meters&#39;)</dt>
<dd>

<p>(This is likely to become a standard option in a future release) The unit of the output map. By default, this is &#39;meters&#39; for UTM, but you may specify &#39;deg&#39; or &#39;km&#39; or even (heaven help us) &#39;miles&#39; if you prefer.</p>

</dd>
<dt id="sz-subzone-SubZone-default-1">sz, subzone, SubZone (default 1)</dt>
<dd>

<p>Set this to -1 for the southern hemisphere subzone. Ultimately you should be able to set it to a letter to get the corresponding military subzone, but that&#39;s too much effort for now.</p>

</dd>
<dt id="gk-gausskruger-default-0">gk, gausskruger (default 0)</dt>
<dd>

<p>Set this to 1 to get the (European-style) tangent-plane Mercator with standard parallel on the prime meridian. The default of 0 places the standard parallels 180km east/west of the prime meridian, yielding better average scale across the zone. Setting gk=&gt;1 makes the scale exactly 1.0 at the central meridian, and &gt;1.0 everywhere else on the projection. The difference in scale is about 0.3%.</p>

</dd>
</dl>

<h2 id="t_sin_lat">t_sin_lat</h2>

<pre><code>    $t = t_sin_lat(&lt;options&gt;);</code></pre>

<p>(Cartography) Cyl. equal-area projection (cyl.; authalic)</p>

<p>This projection is commonly used in solar Carrington plots; but not much for terrestrial mapping.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS4">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="s-std-Standard-default-01">s,std, Standard (default 0)</dt>
<dd>

<p>This is the parallel at which the map is conformal. It is also conformal at the parallel of opposite sign. The conformality is achieved by matched vertical stretching and horizontal squishing (to achieve constant area).</p>

</dd>
</dl>

<h2 id="t_sinusoidal">t_sinusoidal</h2>

<pre><code>    $t = t_sinusoidal(&lt;options&gt;);</code></pre>

<p>(Cartography) Sinusoidal projection (authalic)</p>

<p>Sinusoidal projection preserves the latitude scale but scales longitude according to sin(lat); in this respect it is the companion to <a href="#t_sin_lat">&quot;t_sin_lat&quot;</a>, which is also authalic but preserves the longitude scale instead.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS5">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
</dl>

<h2 id="t_conic">t_conic</h2>

<pre><code>    $t = t_conic(&lt;options&gt;)</code></pre>

<p>(Cartography) Simple conic projection (conic; equidistant)</p>

<p>This is the simplest conic projection, with parallels mapped to equidistant concentric circles. It is neither authalic nor conformal. This transformation is also referred to as the &quot;Modified Transverse Mercator&quot; projection in several maps of Alaska published by the USGS; and the American State of New Mexico re-invented the projection in 1936 for an official map of that State.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS6">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="s-std-Standard-default-29.5-45.5">s, std, Standard (default 29.5, 45.5)</dt>
<dd>

<p>The locations of the standard parallel(s) (where the cone intersects the surface of the sphere). If you specify only one then the other is taken to be the nearest pole. If you specify both of them to be one pole then you get an equidistant azimuthal map. If you specify both of them to be opposite and equidistant from the equator you get a Plate Carree projection.</p>

</dd>
</dl>

<h2 id="t_albers">t_albers</h2>

<pre><code>    $t = t_albers(&lt;options&gt;)</code></pre>

<p>(Cartography) Albers conic projection (conic; authalic)</p>

<p>This is the standard projection used by the US Geological Survey for sectionals of the 50 contiguous United States of America.</p>

<p>The projection reduces to the Lambert equal-area conic (infrequently used and not to be confused with the Lambert conformal conic, <a href="#t_lambert">&quot;t_lambert&quot;</a>!) if the pole is used as one of the two standard parallels.</p>

<p>Notionally, this is a conic projection onto a cone that intersects the sphere at the two standard parallels; it works best when the two parallels straddle the region of interest.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS7">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="s-std-standard-Standard-default-29.5-45.5">s, std, standard, Standard (default (29.5,45.5))</dt>
<dd>

<p>The locations of the standard parallel(s). If you specify only one then the other is taken to be the nearest pole and a Lambert Equal-Area Conic map results. If you specify both standard parallels to be the same pole, then the projection reduces to the Lambert Azimuthal Equal-Area map as aq special case. (Note that <a href="#t_lambert">&quot;t_lambert&quot;</a> is Lambert&#39;s Conformal Conic, the most commonly used of Lambert&#39;s projections.)</p>

<p>The default values for the standard parallels are those chosen by Adams for maps of the lower 48 US states: (29.5,45.5). The USGS recommends (55,65) for maps of Alaska and (8,18) for maps of Hawaii -- these latter are chosen to also include the Canal Zone and Philippine Islands farther south, which is why both of those parallels are south of the Hawaiian islands.</p>

<p>The transformation reduces to the cylindrical equal-area (sin-lat) transformation in the case where the standard parallels are opposite and equidistant from the equator, and in fact this is implemented by a call to t_sin_lat.</p>

</dd>
</dl>

<h2 id="t_lambert">t_lambert</h2>

<pre><code>    $t = t_lambert(&lt;options&gt;);</code></pre>

<p>(Cartography) Lambert conic projection (conic; conformal)</p>

<p>Lambert conformal conic projection is widely used in aeronautical charts and state base maps published by the USA&#39;s FAA and USGS. It&#39;s especially useful for mid-latitude charts. In particular, straight lines approximate (but are not exactly) great circle routes of up to ~2 radians.</p>

<p>The default standard parallels are 33 and 45 to match the USGS state 1:500,000 base maps of the United States. At scales of 1:500,000 and larger, discrepancies between the spherical and ellipsoidal projections become important; use care with this projection on spheres.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS8">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="s-std-standard-Standard-default-33-45">s, std, standard, Standard (default (33,45))</dt>
<dd>

<p>The locations of the standard parallel(s) for the conic projection. The transform reduces to the Mercator projection in the case where the standard parallels are opposite and equidistant from the equator, and in fact this is implemented by a call to t_mercator.</p>

</dd>
<dt id="c-clip-Clip-default--75-75">c, clip, Clip (default [-75,75])</dt>
<dd>

<p>Because the transform is conformal, the distant pole is displaced to infinity. Many applications require a clipping boundary. The value is in whatever angular unit you set with the standard &#39;unit&#39; option. For consistency with <a href="#t_mercator">&quot;t_mercator&quot;</a>, clipping works the same way even though in most cases only one pole needs it. Set this to 0 for no clipping at all.</p>

</dd>
</dl>

<h2 id="t_stereographic">t_stereographic</h2>

<pre><code>    $t = t_stereographic(&lt;options&gt;);</code></pre>

<p>(Cartography) Stereographic projection (az.; conf.; persp.)</p>

<p>The stereographic projection is a true perspective (planar) projection from a point on the spherical surface opposite the origin of the map.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS9">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="c-clip-Clip-default-120">c, clip, Clip (default 120)</dt>
<dd>

<p>This is the angular distance from the center to the edge of the projected map. The default 120 degrees gives you most of the opposite hemisphere but avoids the hugely distorted part near the antipodes.</p>

</dd>
</dl>

<h2 id="t_gnomonic">t_gnomonic</h2>

<pre><code>    $t = t_gnomonic(&lt;options&gt;);</code></pre>

<p>(Cartography) Gnomonic (focal-plane) projection (az.; persp.)</p>

<p>The gnomonic projection projects a hemisphere onto a tangent plane. It is useful in cartography for the property that straight lines are great circles; and it is useful in scientific imaging because it is the projection generated by a simple optical system with a flat focal plane.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS10">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="c-clip-Clip-default-75">c, clip, Clip (default 75)</dt>
<dd>

<p>This is the angular distance from the center to the edge of the projected map. The default 75 degrees gives you most of the hemisphere but avoids the hugely distorted part near the horizon.</p>

</dd>
</dl>

<h2 id="t_az_eqd">t_az_eqd</h2>

<pre><code>  $t = t_az_eqd(&lt;options&gt;);</code></pre>

<p>(Cartography) Azimuthal equidistant projection (az.; equi.)</p>

<p>Basic azimuthal projection preserving length along radial lines from the origin (meridians, in the original polar aspect). Hence, both azimuth and distance are correct for journeys beginning at the origin.</p>

<p>Applied to the celestial sphere, this is the projection made by fisheye lenses; it is also the projection into which <code>t_vertical</code> puts perspective views.</p>

<p>The projected plane scale is normally taken to be planetary radii; this is useful for cartographers but not so useful for scientific observers. Setting the &#39;t=&gt;1&#39; option causes the output scale to shift to camera angular coordinates (the angular unit is determined by the standard &#39;Units&#39; option; default is degrees).</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS11">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="c-clip-Clip-default-180-degrees">c, clip, Clip (default 180 degrees)</dt>
<dd>

<p>The largest angle relative to the origin. Default is the whole sphere.</p>

</dd>
</dl>

<h2 id="t_az_eqa">t_az_eqa</h2>

<pre><code>  $t = t_az_eqa(&lt;options&gt;);</code></pre>

<p>(Cartography) Azimuthal equal-area projection (az.; auth.)</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS12">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="c-clip-Clip-default-180-degrees1">c, clip, Clip (default 180 degrees)</dt>
<dd>

<p>The largest angle relative to the origin. Default is the whole sphere.</p>

</dd>
</dl>

<h2 id="t_aitoff">t_aitoff</h2>

<p><code>t_aitoff</code> in an alias for <code>t_hammer</code></p>

<h2 id="t_hammer">t_hammer</h2>

<p>(Cartography) Hammer/Aitoff elliptical projection (az.; auth.)</p>

<p>The Hammer/Aitoff projection is often used to display the Celestial sphere. It is mathematically related to the Lambert Azimuthal Equal-Area projection (<a href="#t_az_eqa">&quot;t_az_eqa&quot;</a>), and maps the sphere to an ellipse of unit eccentricity, with vertical radius sqrt(2) and horizontal radius of 2 sqrt(2).</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS13">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
</dl>

<h2 id="t_zenithal">t_zenithal</h2>

<p>Vertical projections are also called &quot;zenithal&quot;, and <code>t_zenithal</code> is an alias for <code>t_vertical</code>.</p>

<h2 id="t_vertical">t_vertical</h2>

<pre><code>    $t = t_vertical(&lt;options&gt;);</code></pre>

<p>(Cartography) Vertical perspective projection (az.; persp.)</p>

<p>Vertical perspective projection is a generalization of <a href="#t_gnomonic">gnomonic</a> and <a href="#t_stereographic">stereographic</a> projection, and a special case of <a href="#t_perspective">perspective</a> projection. It is a projection from the sphere onto a tangent plane from a point at the camera location.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS14">STANDARD POSITIONAL OPTIONS</dt>
<dd>

</dd>
<dt id="m-mask-Mask-h-hemisphere-Hemisphere-default-near1">m, mask, Mask, h, hemisphere, Hemisphere [default &#39;near&#39;]</dt>
<dd>

<p>The hemisphere to keep in the projection (see <a href="./Cartography.html">PDL::Transform::Cartography</a>).</p>

</dd>
<dt id="r0-R0-radius-d-dist-distance-default-2.0">r0, R0, radius, d, dist, distance [default 2.0]</dt>
<dd>

<p>The altitude of the focal plane above the center of the sphere. The default places the point of view one radius above the surface.</p>

</dd>
<dt id="t-telescope-Telescope-cam-Camera-default">t, telescope, Telescope, cam, Camera (default &#39;&#39;)</dt>
<dd>

<p>If this is set, then the central scale is in telescope or camera angular units rather than in planetary radii. The angular units are parsed as with the normal &#39;u&#39; option for the lon/lat specification. If you specify a non-string value (such as 1) then you get telescope-frame radians, suitable for working on with other transformations.</p>

</dd>
<dt id="f-fish-fisheye-default">f, fish, fisheye (default &#39;&#39;)</dt>
<dd>

<p>If this is set then the output is in azimuthal equidistant coordinates instead of in tangent-plane coordinates. This is a convenience function for &#39;(t_az_eqd) x !(t_gnomonic) x (t_vertical)&#39;.</p>

</dd>
</dl>

<h2 id="t_perspective">t_perspective</h2>

<pre><code>    $t = t_perspective(&lt;options&gt;);</code></pre>

<p>(Cartography) Arbitrary perspective projection</p>

<p>Perspective projection onto a focal plane from an arbitrary location within or without the sphere, with an arbitrary central look direction, and with correction for magnification within the optical system.</p>

<p>In the forward direction, t_perspective generates perspective views of a sphere given (lon/lat) mapping or vector information. In the reverse direction, t_perspective produces (lon/lat) maps from aerial or distant photographs of spherical objects.</p>

<p>Viewpoints outside the sphere treat the sphere as opaque by default, though you can use the &#39;m&#39; option to specify either the near or far surface (relative to the origin). Viewpoints below the surface treat the sphere as transparent and undergo a mirror reversal for consistency with projections that are special cases of the perspective projection (e.g. t_gnomonic for r0=0 or t_stereographic for r0=-1).</p>

<p>Magnification correction handles the extra edge distortion due to higher angles between the focal plane and focused rays within the optical system of your camera. If you do not happen to know the magnification of your camera, a simple rule of thumb is that the magnification of a reflective telescope is roughly its focal length (plate scale) divided by its physical length; and the magnification of a compound refractive telescope is roughly twice its physical length divided by its focal length. Simple optical systems with a single optic have magnification = 1. Fisheye lenses have magnification &lt; 1.</p>

<p>This transformation was derived by direct geometrical calculation rather than being translated from Voxland &amp; Snyder.</p>

<p>OPTIONS</p>

<dl>

<dt id="STANDARD-POSITIONAL-OPTIONS15">STANDARD POSITIONAL OPTIONS</dt>
<dd>

<p>As always, the &#39;origin&#39; field specifies the sub-camera point on the sphere.</p>

<p>The &#39;roll&#39; option is the roll angle about the sub-camera point, for consistency with the other projectons.</p>

</dd>
<dt id="p-ptg-pointing-Pointing-default-0-0-0">p, ptg, pointing, Pointing (default (0,0,0))</dt>
<dd>

<p>The pointing direction, in (horiz. offset, vert. offset, roll) of the camera relative to the center of the sphere. This is a spherical coordinate system with the origin pointing directly at the sphere and the pole pointing north in the pre-rolled coordinate system set by the standard origin. It&#39;s most useful for space-based images taken some distance from the body in question (e.g. images of other planets or the Sun).</p>

<p>Be careful not to confuse &#39;p&#39; (pointing) with &#39;P&#39; (P angle, a standard synonym for roll).</p>

</dd>
<dt id="c-cam-camera-Camera-default-undef">c, cam, camera, Camera (default undef)</dt>
<dd>

<p>Alternate way of specifying the camera pointing, using a spherical coordinate system with poles at the zenith (positive) and nadir (negative) -- this is useful for aerial photographs and such, where the point of view is near the surface of the sphere. You specify (azimuth from N, altitude from horizontal, roll from vertical=up). If you specify pointing by this method, it overrides the &#39;pointing&#39; option, above. This coordinate system is most useful for aerial photography or low-orbit work, where the nadir is not necessarily the most interesting part of the scene.</p>

</dd>
<dt id="r0-R0-radius-d-dist-distance-default-2.01">r0, R0, radius, d, dist, distance [default 2.0]</dt>
<dd>

<p>The altitude of the point of view above the center of the sphere. The default places the point of view 1 radius aboove the surface. Do not confuse this with &#39;r&#39;, the standard origin roll angle! Setting r0 &lt; 1 gives a viewpoint inside the sphere. In that case, the images are mirror-reversed to preserve the chiralty of the perspective. Setting r0=0 gives gnomonic projections; setting r0=-1 gives stereographic projections. Setting r0 &lt; -1 gives strange results.</p>

</dd>
<dt id="iu-im_unit-image_unit-Image_Unit-default-degrees">iu, im_unit, image_unit, Image_Unit (default &#39;degrees&#39;)</dt>
<dd>

<p>This is the angular units in which the viewing camera is calibrated at the center of the image.</p>

</dd>
<dt id="mag-magnification-Magnification-default-1.0">mag, magnification, Magnification (default 1.0)</dt>
<dd>

<p>This is the magnification factor applied to the optics -- it affects the amount of tangent-plane distortion within the telescope. 1.0 yields the view from a simple optical system; higher values are telescopic, while lower values are wide-angle (fisheye). Higher magnification leads to higher angles within the optical system, and more tangent-plane distortion at the edges of the image. The magnification is applied to the incident angles themselves, rather than to their tangents (simple two-element telescopes magnify tan(theta) rather than theta itself); this is appropriate because wide-field optics more often conform to the equidistant azimuthal approximation than to the tangent plane approximation. If you need more detailed control of the relationship between incident angle and focal-plane position, use mag=1.0 and compose the transform with something else to tweak the angles.</p>

</dd>
<dt id="m-mask-Mask-h-hemisphere-Hemisphere-default-near2">m, mask, Mask, h, hemisphere, Hemisphere [default &#39;near&#39;]</dt>
<dd>

<p>&#39;hemisphere&#39; is by analogy to other cartography methods although the two regions to be selected are not really hemispheres.</p>

</dd>
<dt id="f-fov-field_of_view-Field_Of_View-default-60-degrees">f, fov, field_of_view, Field_Of_View [default 60 degrees]</dt>
<dd>

<p>The field of view of the telescope -- sets the crop radius on the focal plane. If you pass in a scalar, you get a circular crop. If you pass in a 2-element list ref, you get a rectilinear crop, with the horizontal &#39;radius&#39; and vertical &#39;radius&#39; set separately.</p>

</dd>
</dl>

<p>EXAMPLES</p>

<p>Model a camera looking at the Sun through a 10x telescope from Earth (~230 solar radii from the Sun), with an 0.5 degree field of view and a solar P (roll) angle of 30 degrees, in February (sub-Earth solar latitude is 7 degrees south). Convert a solar FITS image taken with that camera to a FITS lon/lat map of the Sun with 20 pixels/degree latitude:</p>

<pre><code>  # Define map output header (no need if you don&#39;t want a FITS output map)
  $maphdr = {NAXIS1=&gt;7200,NAXIS2=&gt;3600,            # Size of image
             CTYPE1=&gt;longitude,CTYPE2=&gt;latitude,   # Type of axes
             CUNIT1=&gt;deg,CUNIT2=&gt;deg,              # Unit of axes
             CDELT1=&gt;0.05,CDELT2=&gt;0.05,            # Scale of axes
             CRPIX1=&gt;3601,CRPIX2=&gt;1801,            # Center of map
             CRVAL1=&gt;0,CRVAL2=&gt;0                   # (lon,lat) of center 
             };

  # Set up the perspective transformation, and apply it.
  $t = t_perspective(r0=&gt;229,fov=&gt;0.5,mag=&gt;10,P=&gt;30,B=&gt;-7);
  $map = $im-&gt;map( $t , $maphdr );</code></pre>

<p>Draw an aerial-view map of the Chesapeake Bay, as seen from a sounding rocket at an altitude of 100km, looking NNE from ~200km south of Washington (the radius of Earth is 6378 km; Washington D.C. is at roughly 77W,38N). Superimpose a linear coastline map on a photographic map.</p>

<pre><code>  $x = graticule(1,0.1)-&gt;glue(1,earth_coast());
  $t = t_perspective(r0=&gt;6478/6378.0,fov=&gt;60,cam=&gt;[22.5,-20],o=&gt;[-77,36])
  $w = pgwin(size=&gt;[10,6],J=&gt;1);
  $w-&gt;fits_imag(earth_image()-&gt;map($t,[800,500],{m=&gt;linear}));
  $w-&gt;hold;
  $w-&gt;lines($x-&gt;apply($t),{xt=&gt;&#39;Degrees&#39;,yt=&gt;&#39;Degrees&#39;});
  $w-&gt;release;</code></pre>

<p>Model a 5x telescope looking at Betelgeuse with a 10 degree field of view (since the telescope is looking at the Celestial sphere, r is 0 and this is just an expensive modified-gnomonic projection).</p>

<pre><code>  $t = t_perspective(r0=&gt;0,fov=&gt;10,mag=&gt;5,o=&gt;[88.79,7.41])</code></pre>


</body>

</html>


